{% extends 'base.html' %}

{% block title %}Search results{% endblock %}

{% block content %}
<form action="/search/">
    <button type="submit"> Previous page </button>
</form>
<h1>Result</h1>
<div class="container_table">
    <div id="download_div">
        <input class="check_button_format" type="checkbox" id="bpseq" value=".bpseq">
        <label for="bpseq"> bpseq format</label><br>
        <input class="check_button_format" type="checkbox" id="bpseq_nH" value="nH.bpseq">
        <label for="bpseq_nh"> bpseq-nH format</label><br>
        <input class="check_button_format" type="checkbox" id="ct" value=".ct">
        <label for="ct"> ct format</label><br>
        <input class="check_button_format" type="checkbox" id="ct_nH" value="nH.ct">
        <label for="ct_nh"> ct-nH format</label><br>
        <input class="check_button_format" type="checkbox" id="db" value=".db">
        <label for="db"> db format</label><br>
        <input class="check_button_format" type="checkbox" id="db_nh" value="nH.db">
        <label for="db_nh"> db-nH format</label><br>
        <button type="button"  id="dl_button" onclick="download_file_from_db(),download() ">Download</button>
    </div>
    <table class="result_table" id="result_table">
    <thead>
         <tr>
             <th><input id="check_all" type="checkbox"></th>
             <th>Organism name</th>
             <th>Reference ID</th>
             <th>Accession Number</th>
             <th>RNA Type</th>
             <th>More Information</th>
         </tr>
    </thead>
    <tbody class="result_tbody">
        {% for element in result_list %}
        <tr id="table_row" >
            <td>
                <input class="check_button" type="checkbox" name="id_checkbox" id="{{ element['Benchmark ID'] }}">
            </td>
            <td >
                {{ element['Organism name'] }}
            </td>
            <td id="ref_id">
                {{ element['Benchmark ID'] }}
            </td>
            <td>
                {{ element['Accession number'] }}
            </td>
            <td>
                {{ element['Rna Type'] }}
            </td>
            <td onclick="showHideRow('hidden_row{{ element['Benchmark ID'] }}'), show_taxonomy()">
                +
            </td>
        </tr>
        <tr id="hidden_row{{ element['Benchmark ID'] }}" class="hidden_row">
            <td colspan="14">
                <p>Organism name: {{ element['Organism name'] }}</p>
                <p>Accession number: {{ element['Accession number'] }}</p>
                <p>Length: {{ element['Length'] }}</p>
                <p>Number of decoupled nucleotides: {{ element['Number of decoupled nucleotides'] }}</p>
                <p>Number of weak bonds: {{ element['Number of weak bonds'] }}</p>
                <p>Is pseudoknotted: {{ element['Is Pseudoknotted'] }}</p>
                <p>Pseudoknot order: {{ element['Pseudoknot order'] }}</p>
                <p>Rna type: {{ element['Rna Type'] }}</p>
                <p>Genus: {{ element['Genus'] }}</p>
                <p>Core: {{ element['Core'] }}</p>
                <p>Core plus: {{ element['Core plus'] }}</p>
                <p>Shape: {{ element['Shape'] }}</p>
                <p>Reference ID: {{ element['Benchmark ID'] }}</p>
                <p>Database name: inserire campo db</p>
                <p>Database link: inserire campo db link</p>
                <hr>
                <p>Taxonomy:</p>
                <div id="silva_div">
                    <p>SILVA:</p>
                    <p  style="display: none;" id="silva_taxonomy" >{{ element['Taxonomy'][0]['SILVA']}}</p>
                </div>
                <div id="ena_div">
                    <p>ENA:</p>
                    <p  style="display: none;" id="ena_taxonomy" >{{ element['Taxonomy'][1]['ENA']}}</p>
                </div>
                <div id="ltp_div">
                    <p>LTP:</p>
                    <p  style="display: none;" id="ltp_taxonomy" >{{ element['Taxonomy'][2]['LTP']}}</p>
                </div>
                <div id="ncbi_div">
                    <p>NCBI:</p>
                    <p  style="display: none;" id="ncbi_taxonomy" >{{ element['Taxonomy'][3]['NCBI']}}</p>
                </div>
                <div id="gtdb_div">
                    <p>GTDB:</p>
                    <p  style="display: none;" id="gtdb_taxonomy" >{{ element['Taxonomy'][4]['GTDB']}}</p>
                </div>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
    <script>
    $(function() {
        //If check_all checked then check all table rows
        $("#check_all").on("click", function () {
            if ($("#check_all").prop("checked")) {
                $(".check_button").prop("checked", true);
            } else {
                $(".check_button").prop("checked", false);
            }
        });

    })
</script>
{% endblock %}
